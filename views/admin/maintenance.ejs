<%- include('_head', { title: 'Maintenance', active: 'maintenance' }) %>
<%- include('_flash', { success: success, error: error }) %>

<div class="max-w-lg mx-auto bg-white rounded-lg shadow-md p-6">
  <h3 class="text-xl font-semibold mb-4">Flush Data</h3>
  <p class="text-gray-600 mb-4">Tindakan ini akan menghapus seluruh data pengguna, server, permintaan N8n, permintaan klaim, dan promosi.</p>
  <button id="flushBtn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md transition">
    🗑️ Flush Semua Data
  </button>
</div>

<script>
  document.getElementById('flushBtn').addEventListener('click', async () => {
    if(!confirm('Anda yakin ingin menghapus SEMUA data? Tindakan ini irreversible.')) return;
    try {
      const res = await fetch('/admin/flush', { method: 'POST', headers: { 'Content-Type': 'application/json' } });
      const data = await res.json();
      if(data.success){
        alert('Berhasil di-flush!');
        location.reload();
      } else {
        alert('Gagal: '+data.message);
      }
    } catch(err){
      alert('Error: '+err.message);
    }
  });
</script>

<%- include('_foot') %>
